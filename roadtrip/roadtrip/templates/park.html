{% extends "base.html" %}
{% load cms_tags sekizai_tags menu_tags roadtrip_tags staticfiles %}


{% block "content" %}

{% addtoblock "css" %}
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
{% endaddtoblock %}

{% addtoblock "js" %}
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script type="text/javascript" src="http://oauth.googlecode.com/svn/code/javascript/oauth.js"></script>
<script type="text/javascript" src="http://oauth.googlecode.com/svn/code/javascript/sha1.js"></script>

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD4y5vgVMb3bcqjYsaYJzJphjJdvnJBr6U&sensor=true&language=zh"></script>
<script type="text/javascript" src="{% static "js/park.js" %}"></script>
<script type="text/javascript" src="{% static "js/infobox_packed.js" %}"></script>
<script type="text/javascript" src="{% static "js/trip.js" %}"></script>



<script type="text/javascript">

   
</script>
{% endaddtoblock %}


<div id="overlay-panel-wrapper">
  <div id="overlay-panel">
    <div>
    <div id="overlay-content">
    </div>
    </div>
  </div>
</div>

<div id='top-nav-area'>
  <div id='top-nav'>
    <ul>
      {% getParks as parks %}
      {% for park in parks %}
      <li class="park-button">
        <a class='park-name' href="./?park={{ park.id }}">{{ park.name_cn }}</a> 
      </li>
      {% endfor %}
    </ul>
    <div id="credentials">
      <ul class="logged-out">
        <li><a class="register" href="/register">注册</a></li>
        <li><a class="login" href="/login">登录</a></li>
      </ul>
    </div>
  </div>
</div>

  
{% getPark request as park %}
{% if park %}

<div>
  {% getPOIs park as pois %}
  {% for poi in pois %}
  <div class="infobox-label hidden">
    {% getPOIPhoto poi.id as photo %}
    <span class="poi-id hidden">{{ poi.id }}</span>
    <div class="infobox-label-img">
      <img src="{{ photo.get_thumbnail_url }}">
    </div>
    <div class="infobox-label-name">
      <p class="infobox-title-cn">{{ poi.name_cn }}</p>
      <p class="infobox-title-en">{{ poi.name_en }}</p>
    </div>
  </div>
  {% endfor %}
</div>

<div id="park-info">
  <span id="park-gps-coordinate">{{ park.center_gps_coordinate }}</span>
  <span id="park-zoom">{{ park.zoom }}</span>
  {% getParkMap park as map %}
  <span id="park-map-filename">{% static "img/maps/" %}{{ map.filename }}</span>
  <span id="park-map-sw-bound">{{ map.gps_southwest_bound }}</span>
  <span id="park-map-ne-bound">{{ map.gps_northeast_bound }}</span>
</div>

<div class="sidebar-poi">
  <div class="sidebar-panel-poi">
    <div id="poi-control-panel">
      <a href="javascript:" id="show-all-pois">显示所有景点</a>
    </div>

  <div id="poi-list-container">
    <div class="poi-list">
    {% getPOIs park as pois %}
    {% for poi in pois %}
    {% if poi.category == '景点'%}
        <div class = 'attraction-item'>
          <div class="poi-item">
            <span class="poi-id">{{ poi.id }}</span>
            <button class="poi-button">
              <p class="poi-name">{{ poi.name_cn }}</p>
              <p class="poi-name-en">{{ poi.name_en }}</p>
              <span class="coordinate">{{ poi.gps_coordinate }}</span>
            </button>
            <button class="zoom-button" >
              <img src="{% static "icon/information.svg" %}" width=25px height=25px></img>
            </button>
            {% getTrails poi as trails %}
            {% if trails|length > 0 %}
              <div class="poi-info">
              {% for trail in trails %}
                <div class="trail-item">
                  <div class="trail-name">{{ trail.name_cn }}</div>
                  <div class="trail-route">{{ trail.routes }}</div>
                </div>
              {% endfor %}
              </div>
            {% endif %}
          </div>
        </div>
    {% endif %}
    {% if poi.category == '饭馆' %}
    <div class="food-item">
      <div class='poi-item'>
        <span class="poi-id">{{ poi.id }}</span>
        <button class="poi-button">
            <p class="poi-name">{{ poi.name_cn }}</p>
            <p class="poi-name-en">{{ poi.name_en }}</p>
            <span class="coordinate">{{ poi.gps_coordinate }}</span>
        </button>
        <button class="zoom-button" >
            <img src="{% static "icon/information.svg" %}" width=25px height=25px></img>
        </button>
      </div>
    </div>
    {% endif %}
    {% if poi.category == '住宿' %}
    <div class="hotel-item">
      <div class='poi-item'>
        <span class="poi-id">{{ poi.id }}</span>
        <button class="poi-button">
            <p class="poi-name">{{ poi.name_cn }}</p>
            <p class="poi-name-en">{{ poi.name_en }}</p>
            <span class="coordinate">{{ poi.gps_coordinate }}</span>
        </button>
        <button class="zoom-button" >
            <img src="{% static "icon/information.svg" %}" width=25px height=25px></img>
        </button>
      </div>
    </div>
    {% endif %}
    {% if poi.category == '开车' %}
    <div class="road-item">
      <div class='poi-item'>
        <span class="poi-id">{{ poi.id }}</span>
        <button class="poi-button">
            <p class="poi-name">{{ poi.name_cn }}</p>
            <p class="poi-name-en">{{ poi.name_en }}</p>
            <span class="coordinate">{{ poi.gps_coordinate }}</span>
        </button>
        <button class="zoom-button" >
            <img src="{% static "icon/information.svg" %}" width=25px height=25px></img>
        </button>
      </div>
    </div>
    {% endif %}
  {% endfor %}
        <div class="poi-empty-item"></div>
      </div>
    </div>
  </div>
</div>





<div id='side-nav'>
  <button class='side-nav-category'>
    <img class='icon-pic' src="/static/img/vintage2.svg"></img>
    <br><hl>景点</hl>
  </button>
  <button class='side-nav-category'>
    <img class='icon-pic' src="/static/img/car75.svg"></img>
    <br><hl>赶路</hl>
  </button>
  <button class='side-nav-category'>
    <img class='icon-pic' src="/static/img/accomodation.svg"></img>
    <br><hl>客栈</hl>
  </button>
  <button class='side-nav-category'>
    <img class='icon-pic' src="/static/img/bon1.svg"></img>
    <br><hl>饕餮</hl>
  </button>
</div>

<div class="map-nav">
  {% if map %}
  <a class="map aside-nav hidden" id="show-official-map">
    <i class="icon-nav-map"></i>
    <span class="action-label"> 官方地图 </span>
  </a>
  {% endif %}
  {% if map %}
  <a class="map aside-nav hidden" id="show-itinerary">
      <i class="icon-nav-map"></i>
      <span class="action-label"> 当前行程 </span>
  </a>
  {% endif %}
</div>



<div id='add-to-trip'>
	<button id='add-to-trip-button'>
		<p'>加入行程</p>
	</button>
</div>

<div id='show-direction'>
	<button id='show-direction-button'>
		<p'>显示路径</p>
	</button>
</div>


<div id='info-panel'>
  <p id='item-name'>您目前旅程：</p>
  <p>{{ message }}</p>
</div>

<div id="map-window">
  <div id="map-canvas">
  </div>
</div>

{% endif %}

{% endblock %}
