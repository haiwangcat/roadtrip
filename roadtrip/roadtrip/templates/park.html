{% extends "base.html" %}
{% load cms_tags sekizai_tags menu_tags roadtrip_tags staticfiles %}


{% block "content" %}

{% addtoblock "css" %}
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
{% endaddtoblock %}

{% addtoblock "js" %}
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD4y5vgVMb3bcqjYsaYJzJphjJdvnJBr6U&sensor=true&language=zh"></script>
<script type="text/javascript" src="{% static "js/park.js" %}"></script>
<script type="text/javascript">

{% comment %}
  $(".park-button").each(function(index) {
      var route_lines = [];
      var bounds = null;
      var node = $(this);

      try {
        $(this).click(function () {
        	if (($this).hasClass('selected'){
        		$(this).removeClass('selected');
        	}
        	else {
        		$(this).addClass('selected');
        	}
         });
      }catch(e){}
  });
{% endcomment %}
        

</script>
{% endaddtoblock %}


<div id='top-nav-area'>
  <ul id='top-nav'>
{% getParks as parks %}
{% for park in parks %}
    <li class="park-button">
      <a class='park-name' href="./?park={{ park.park_id }}">{{ park.name_cn }}</a> 
    </li>
{% endfor %}
  </ul>
</div>

  
{% getParkSlug request as slug %}
{% if slug != "" %}

<div id="sidebar">
  <div id="sidebar-panel">
    <button id="show-all-pois">显示所有景点</button>
    <div id="poi-list">
      {% getPOI slug as pois %}
      {% for poi in pois %}
        {% if poi.poi_type == "POI" %}
        <div class="poi-item">
          <button class="poi-button">
            <span class="poi-name">{{ poi.name_cn }}</span>
            <span class="coordinate">{{ poi.gps }}</span>
          </button>
          <button class="zoom-button">+</button>
          {% if poi.trails|length > 0 %}
            <div class="poi-info">
            {% for trail in poi.trails %}
              <div class="trail-item">
                <div class="trail-name">{{ trail.name_cn }}</div>
                <div class="trail-route">{{ trail.routes }}</div>
              </div>
            {% endfor %}
            </div>
          {% endif %}
        </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<div id='info-panel'>
  <p id='item-name'></p>
</div>

<div id="map-window">
  <div id="map-canvas">
  </div>
</div>

{% endif %}

{% endblock %}
